<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Price Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            100: '#374151',
                            200: '#1F2937',
                            300: '#111827',
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-dark-300 to-blue-900 text-white min-h-screen">
    <!-- Previous HTML remains the same until settings modal -->

    <!-- Updated Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm hidden items-center justify-center">
        <div class="bg-gradient-to-br from-dark-200 to-blue-900/50 p-6 rounded-lg w-full max-w-md">
            <h2 class="text-2xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400">Settings</h2>
            <div class="mb-4">
                <label for="botToken" class="block mb-2">Telegram Bot Token:</label>
                <input type="text" id="botToken" class="w-full p-2 bg-dark-100/50 border border-gray-600 rounded backdrop-blur-sm">
            </div>
            <div class="mb-4">
                <label for="chatId" class="block mb-2">Telegram Chat ID:</label>
                <input type="text" id="chatId" class="w-full p-2 bg-dark-100/50 border border-gray-600 rounded backdrop-blur-sm">
            </div>
            <div class="mb-4">
                <label for="refreshInterval" class="block mb-2">Price Refresh Interval (seconds):</label>
                <select id="refreshInterval" class="w-full p-2 bg-dark-100/50 border border-gray-600 rounded backdrop-blur-sm">
                    <option value="10">10 seconds</option>
                    <option value="30">30 seconds</option>
                    <option value="60">1 minute</option>
                    <option value="300">5 minutes</option>
                    <option value="600">10 minutes</option>
                </select>
            </div>
            <div class="flex justify-end mt-4">
                <button id="saveSettings" class="bg-gradient-to-r from-blue-600 to-blue-800 text-white px-4 py-2 rounded hover:from-blue-700 hover:to-blue-900 transition duration-300">Save</button>
                <button id="closeSettings" class="bg-gradient-to-r from-red-600 to-red-800 text-white px-4 py-2 rounded hover:from-red-700 hover:to-red-900 transition duration-300 ml-2">Close</button>
            </div>
        </div>
    </div>

    <script>
        let symbols = JSON.parse(localStorage.getItem('symbols')) || ['BTC', 'ETH', 'EIGEN', 'ZRO', 'ZK','S','IO','CAKE'];
        const baseUrl = 'https://api.binance.com/api/v3/ticker/';
        const quoteAsset = 'USDT';
        let isGridView = true;
        let settings = JSON.parse(localStorage.getItem('settings')) || {
            refreshInterval: 60 // Default refresh interval in seconds
        };
        let priceAlerts = JSON.parse(localStorage.getItem('priceAlerts')) || {};
        let refreshIntervalId;

        // Previous functions remain the same...

        function startPriceRefresh() {
            // Clear existing interval if any
            if (refreshIntervalId) {
                clearInterval(refreshIntervalId);
            }
            
            // Set new interval
            const intervalInMs = (settings.refreshInterval || 60) * 1000;
            refreshIntervalId = setInterval(fetchPrices, intervalInMs);
            
            // Update last refresh time display
            updateLastRefreshTime();
        }

        function updateLastRefreshTime() {
            const refreshTimeElement = document.getElementById('lastRefreshTime');
            if (refreshTimeElement) {
                refreshTimeElement.textContent = moment().format('HH:mm:ss');
            }
        }

        document.getElementById('settingsBtn').addEventListener('click', function() {
            document.getElementById('settingsModal').classList.remove('hidden');
            document.getElementById('settingsModal').classList.add('flex');
            document.getElementById('botToken').value = settings.botToken || '';
            document.getElementById('chatId').value = settings.chatId || '';
            document.getElementById('refreshInterval').value = settings.refreshInterval || '60';
        });

        document.getElementById('saveSettings').addEventListener('click', function() {
            settings.botToken = document.getElementById('botToken').value;
            settings.chatId = document.getElementById('chatId').value;
            settings.refreshInterval = parseInt(document.getElementById('refreshInterval').value);
            localStorage.setItem('settings', JSON.stringify(settings));
            document.getElementById('settingsModal').classList.add('hidden');
            document.getElementById('settingsModal').classList.remove('flex');
            
            // Restart price refresh with new interval
            startPriceRefresh();
        });

        // Initialize
        window.onload = function() {
            fetchPrices();
            startPriceRefresh();
        };
    </script>
</body>
</html>
